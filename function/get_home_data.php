<?php 	include("koneksi.php");	include("validate_string.php");	include("helper_function.php");	include("show_message.php");		$receive = "NULL";	$is_end_of_data = 0;		$FILTER_FIELD_NAME 	= "nama_barang";		//Table yg di akses pada get_home_data	$TABLE_BARANG 		= "barang";	$TABLE_PENJUAL 		= "penjual";	$TABLE_MEREK		= "merek";		$START_FROM			= 0;	$LIMIT_DATA			= 50;	$FIELD_ID_BARANG	= "id_barang";	$FIELD_ID_USER		= "id_user";	$FIELD_NAMA_BARANG	= "nama_barang";		//Ordering by this table field	$order_by = "id_barang";		$header_barang		= "BARANG";	$header_returned_data_penjual = "SUPPLIER";	$header_returned_data_merek = "BRAND";	$header_returned_data_kategori = "CATEGORY";	$header_data_size	= "DATA_SIZE";	$header_query		= "QUERY";	$header_receive_data= "RECEIVE_DATA";	$header_status_akhir_data = "END_OF_DATA";		//Inisialisasi Start and Limit Data	if(isset($_POST['start_from']) || isset($_POST['limit']) ) {			$START_FROM = intval($_POST['start_from']);		$LIMIT_DATA = intval($_POST['limit']);			}		$selected_fields = 	"id_barang, id_merek, id_penjual, id_gambar, nama_barang, stok_barang"						.", satuan_barang, harga_barang, tgl_harga_stok_barang, kode_barang, lokasi_barang"						.", kategori_barang, deskripsi_barang, id_favorite";		$QUERY_PENJUAL = sprintf("SELECT * FROM %s", $TABLE_PENJUAL); 	$QUERY_MEREK = sprintf("SELECT * FROM %s", $TABLE_MEREK);	$QUERY_KATEGORI = sprintf("SELECT distinct(kategori_barang) AS kategori_barang FROM %s ", $TABLE_BARANG);	$QUERY_JLH_BRG = "SELECT count(id_barang) as jlh_brg FROM barang";		$execute_jlh_brg = mysql_query($QUERY_JLH_BRG) or die(mysql_error());	$jlh_brg_array = mysql_fetch_array($execute_jlh_brg);	$jlh_brg = $jlh_brg_array['jlh_brg'];	$page_num = ceil($jlh_brg/$LIMIT_DATA);		if( isset( $_GET['q'] ) ) {		//Mencari data barang		$searchKey = $_GET['q'];				$QUERY = sprintf("SELECT $selected_fields FROM %s WHERE %s LIKE  '%%%s%%' LIMIT %d, %d ", 					  $TABLE_BARANG, 					  $FILTER_FIELD_NAME,					  $searchKey,					  $START_FROM,					  $LIMIT_DATA );			} else if( !isset( $_POST['id_barang'] ) && isset( $_POST['id_user'] ) ) {		//Permintaan normal, mengambil data barang sesuai id_user aktif		//Barang yg dikembalikan akan diurutkan berdasarkan $orderng_by A-Z/0-9 (ASC)				$id_user = intval($_POST['id_user']);				$QUERY = sprintf("SELECT * FROM %s WHERE %s = %d ORDER BY $order_by ASC LIMIT %d, %d", 					  $TABLE_BARANG, 					  $FIELD_ID_USER, $id_user,					  $START_FROM,					  $LIMIT_DATA );				$receive = mysql_escape_string( json_encode($_POST) );		} else if( isset( $_POST['id_barang'] ) && isset( $_POST['id_user'] ) ) {		//permintaan spesifik utk data barang dengan id_barang ini.				$id_barang = $_POST['id_barang'];		$id_user = $_POST['id_user'];				$QUERY = sprintf("SELECT $selected_fields FROM %s WHERE %s = %d AND %s = %d LIMIT %d", 					  $TABLE_BARANG, 					  $FIELD_ID_BARANG, $id_barang,					  $FIELD_ID_USER, $id_user,					  $LIMIT_DATA );				$receive = mysql_escape_string( json_encode($_POST) );		} else {		//Utk keperluan percobaan, hapus utk produksi		$QUERY = sprintf("SELECT $selected_fields FROM %s ORDER BY $order_by LIMIT %d, %d", $TABLE_BARANG, $START_FROM, $LIMIT_DATA );	}		$dataTable = array(); //data barang		$data_penjual = array();	$data_merek = array();	$data_kategori = array();		//Fungsi getMySQLData mengembalikan Array	$dataTable = getMySQLData($QUERY);	$data_penjual = getMySQLData($QUERY_PENJUAL); 	$data_merek = getMySQLData($QUERY_MEREK);	$data_kategori = getMySQLData($QUERY_KATEGORI);		//cek apakah data barang sudah di akhir halaman	$data_per_page = $jlh_brg / $page_num;		//Jika jumlah data satu kali hasil query lebih kecil dari LIMIT permintaan,	//maka itu tanda akhir data.	if( sizeof($dataTable) < $LIMIT_DATA) {			$is_end_of_data = 1;			}		//echo "Jumlah Barang : " . $jlh_brg . ", Number of page : " . $page_num . ", Data per page : " . $data_per_page;			//Jika array yag dikembalikan salah satu data == null, tampilkan pesan error.	if($dataTable == null || $data_penjual == null || $data_merek == null) {		errorMassage();		return;	}				$data_size = sizeof($dataTable);	 	///////////////////////////////////////////////////////////////////////	//////////////////////////MEMULAI KIRIM DATA///////////////////////////		header('Content-type: application/json');		//Final data will send to client side	$data = sprintf('{  	"%s" : %s ,	"%s" : %s ,	"%s" : %s ,	"%s" : %s ,	"%s" : %d , 	"%s" : "%s" , 	"%s" : "%s",	"%s" : %d } ', 				 		$header_barang, json_encode($dataTable, true),		$header_returned_data_penjual, json_encode($data_penjual, true),		$header_returned_data_merek, json_encode($data_merek, true),		$header_returned_data_kategori, json_encode($data_kategori, true),			$header_data_size, $data_size, 		$header_query, $QUERY, 		$header_receive_data, $receive,		$header_status_akhir_data, $is_end_of_data	);	print_r($data);		//Informasi yg dikirimkan kepada client		?>